<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy-Saving Notifications</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="logo">Home Automation</div>
        <ul>
            <li><a href="/"><i class="fas fa-home"></i> Home</a></li>
            <li><a href="/features"><i class="fas fa-cogs"></i> Features</a></li>
            <li><a href="/chat"><i class="fas fa-comments"></i> Chat with ChatGPT</a></li>
            <li><a href="/dashboard"><i class="fas fa-chart-line"></i> Dashboard</a></li>
            <li><a href="/notifications" class="active"><i class="fas fa-bell"></i> Notifications</a></li>
            <li><a href="/login"><i class="fas fa-user"></i> Login/Signup</a></li>
            <li><a href="/about"><i class="fas fa-info-circle"></i> About Us</a></li>
            <li><a href="/contact"><i class="fas fa-envelope"></i> Contact Us</a></li>
        </ul>
    </div>

    <!-- Hamburger menu -->
    <div class="toggle-btn" onclick="toggleSidebar()">
        &#9776;
    </div>

    <!-- Main content -->
    <div class="main-content" id="main-content">
        <section class="notifications-container">
            <h3>Energy-Saving Notifications and AI Advice</h3>
            
            <!-- Dropdown for advice groups -->
            <label for="advice-group">Select Advice Group:</label>
            <select id="advice-group" onchange="fetchNotifications()">
                <% groups.forEach(group => { %>
                    <option value="<%= group.GroupID %>"><%= group.GroupName %></option>
                <% }); %>
            </select>

            <div class="notifications-grid">
                <% if (notifications.length === 0) { %>
                    <div class="notification-card no-data">
                        <i class="fas fa-info-circle"></i>
                        <p>No notifications available at the moment.</p>
                    </div>
                <% } else { %>
                    <% notifications.forEach(notification => { %>
                        <div class="notification-card">
                            <i class="fas fa-lightbulb"></i>
                            <p><%= notification %></p>
                        </div>
                    <% }); %>
                <% } %>
            </div>
        </section>
    </div>

    <script>
        function fetchNotifications() {
    const groupId = document.getElementById('advice-group').value;

    fetch(`/notifications?group=${groupId}`)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            const notificationsGrid = document.querySelector('.notifications-grid');
            notificationsGrid.innerHTML = ''; // Clear existing notifications

            if (data.notifications.length === 0) {
                notificationsGrid.innerHTML = `
                    <div class="notification-card no-data">
                        <i class="fas fa-info-circle"></i>
                        <p>No notifications available for the selected group.</p>
                    </div>
                `;
            } else {
                data.notifications.forEach(notification => {
                    const notificationCard = document.createElement('div');
                    notificationCard.className = 'notification-card';
                    notificationCard.innerHTML = `
                        <i class="fas fa-lightbulb"></i>
                        <p>${notification}</p>
                    `;
                    notificationsGrid.appendChild(notificationCard);
                });
            }
        })
        .catch(error => console.error('Error fetching notifications:', error));
}

    </script>

<script src="/js/frontend.js"></script>

</body>
</html>
